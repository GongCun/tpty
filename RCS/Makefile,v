head	1.2;
access;
symbols;
locks
	GongCun:1.2; strict;
comment	@# @;


1.2
date	2017.03.26.09.33.42;	author GongCun;	state Exp;
branches;
next	1.1;

1.1
date	2017.03.26.07.26.21;	author GongCun;	state Exp;
branches;
next	;


desc
@@


1.2
log
@*** empty log message ***
@
text
@ROOT=..
PLATFORM=$(shell $(ROOT)/systype.sh)
EXTRALIBS=$(shell $(ROOT)/config.sh)
include $(ROOT)/Make.defines.$(PLATFORM)

ifneq (,$(findstring -lcrypto,$(EXTRALIBS)))
	PROGS =	tpty tptyreplay tpty-crypt
else
	PROGS =	tpty tptyreplay
endif

all:	$(PROGS)

tpty:	main.o loop.o do_driver.o $(LIBTPTY)
	$(CC) $(CFLAGS) -o $@@ $(filter %.o,$^) $(LDFLAGS) $(LDLIBS)
	@@cp -p tpty ../bin
	@@cp -p tpty ../dbg

tptyreplay: tptyreplay.o $(LIBTPTY)
	$(CC) $(CFLAGS) -o $@@ $(filter %.o,$^) $(LDFLAGS) $(LDLIBS)
	@@cp -p tptyreplay ../bin
	@@cp -p tptyreplay ../dbg

tpty-crypt: tpty-crypt.o
	$(CC) $(CFLAGS) -o $@@ $(filter %.o,$^) $(LDFLAGS) $(LDLIBS)
	@@cp -p tpty-crypt ../bin
	@@cp -p tpty-crypt ../dbg

clean:
	rm -f $(PROGS) $(TEMPFILES) *.o

include $(ROOT)/Make.libtpty.inc
@


1.1
log
@Initial revision
@
text
@d3 1
a4 1
# include $(ROOT)/Make.defines.dbg
d6 5
a10 4
# EXTRA = -DHAVE_NANOSLEEP -lm -g
EXTRA = -DHAVE_NANOSLEEP -lm -lcrypto

PROGS =	tpty tptyreplay tpty-crypt
d15 1
a15 1
	$(CC) $(CFLAGS) -o tpty main.o loop.o do_driver.o $(LDFLAGS) $(LDLIBS)
d20 1
a20 1
	$(CC) $(CFLAGS) -o tptyreplay tptyreplay.o $(LDFLAGS) $(LDLIBS) $(EXTRA)
d22 1
a22 1
	cp -p tptyreplay ../dbg
d24 2
a25 2
tpty-crypt: tpty-crypt.o $(LIBTPTY)
	$(CC) $(CFLAGS) -o tpty-crypt tpty-crypt.o $(LDFLAGS) $(LDLIBS) $(EXTRA)
@
